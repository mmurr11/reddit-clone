"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{5680:function(n,t,r){r.d(t,{A:function(){return h}});var e=r(5893),o=r(4051),u=r.n(o),i=r(8527),a=r(5113),s=r(1664),c=r(9402),f=r(7786),l=r(1163);function d(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function p(n,t,r,e,o,u,i){try{var a=n[u](i),s=a.value}catch(c){return void r(c)}a.done?t(s):Promise.resolve(s).then(e,o)}function v(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var r=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var e,o,u=[],i=!0,a=!1;try{for(r=r.call(n);!(i=(e=r.next()).done)&&(u.push(e.value),!t||u.length!==t);i=!0);}catch(s){a=!0,o=s}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return u}}(n,t)||function(n,t){if(!n)return;if("string"===typeof n)return d(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var m=function(n){n=null!==n?n:function(n){throw n}(new TypeError("Cannot destructure undefined"));var t,r=(0,l.useRouter)(),o=v((0,c.UE)({pause:(0,f.s)()}),1)[0],d=o.data,m=o.fetching,g=v((0,c._y)(),2),h=g[0].fetching,y=g[1],P=null;return m||(P=(null===d||void 0===d?void 0:d.me)?(0,e.jsxs)(i.kC,{align:"center",children:[(0,e.jsx)(s.default,{href:"/create-post",children:(0,e.jsx)(a.zx,{as:i.rU,mr:4,children:"create post"})}),(0,e.jsx)(i.xu,{mr:2,children:d.me.username}),(0,e.jsx)(a.zx,{onClick:(t=u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y();case 2:r.reload();case 3:case"end":return n.stop()}}),n)})),function(){var n=this,r=arguments;return new Promise((function(e,o){var u=t.apply(n,r);function i(n){p(u,e,o,i,a,"next",n)}function a(n){p(u,e,o,i,a,"throw",n)}i(void 0)}))}),isLoading:h,variant:"link",children:"Logout"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.default,{href:"/login",children:(0,e.jsx)(i.rU,{mr:2,children:"Login"})}),(0,e.jsx)(s.default,{href:"/register",children:(0,e.jsx)(i.rU,{children:"Register"})})]})),(0,e.jsxs)(i.kC,{position:"sticky",top:0,zIndex:1,bg:"tomato",p:4,align:"center",children:[(0,e.jsx)(s.default,{href:"/",children:(0,e.jsx)(i.rU,{children:(0,e.jsx)(i.X6,{children:"It's Reddit!"})})}),(0,e.jsx)(i.xu,{ml:"auto",children:P})]})},g=r(9113),h=function(n){var t=n.children,r=n.variant;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m,{}),(0,e.jsx)(g.i,{variant:r,children:t})]})}},9113:function(n,t,r){r.d(t,{i:function(){return u}});var e=r(5893),o=r(8527),u=function(n){var t=n.children,r=n.variant,u=void 0===r?"medium":r;return(0,e.jsx)(o.xu,{mt:8,mx:"auto",maxW:"medium"===u?"800px":"400px",w:"100%",children:t})}},9402:function(n,t,r){r.d(t,{$h:function(){return k},u3:function(){return Z},jn:function(){return R},zN:function(){return _},YA:function(){return M},_y:function(){return F},l4:function(){return N},Bq:function(){return L},ot:function(){return Q},en:function(){return T},UE:function(){return G},Ss:function(){return V},Bm:function(){return X}});var e=r(210),o=r(2432);function u(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function i(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},e=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})))),e.forEach((function(t){u(n,t,r[t])}))}return n}function a(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function s(){var n=a(["\n  fragment PostSnippet on Post {\n    id\n    createdAt\n    updatedAt\n    title\n    textSnippet\n    points\n    voteStatus\n    creator {\n      username\n      id\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=a(["\n  fragment RegularError on FieldError {\n    field\n    message\n  }\n"]);return c=function(){return n},n}function f(){var n=a(["\n  fragment RegularUser on User {\n    id\n    username\n  }\n"]);return f=function(){return n},n}function l(){var n=a(["\n  fragment RegularUserResponse on UserResponse {\n    errors {\n      ...RegularError\n    }\n    user {\n      ...RegularUser\n    }\n  }\n  ","\n  ","\n"]);return l=function(){return n},n}function d(){var n=a(["\n  mutation ChangePassword($token: String!, $newPassword: String!) {\n    changePassword(token: $token, newPassword: $newPassword) {\n      ...RegularUserResponse\n    }\n  }\n  ","\n"]);return d=function(){return n},n}function p(){var n=a(["\n  mutation CreatePost($input: PostInput!) {\n    createPost(input: $input) {\n      id\n      createdAt\n      updatedAt\n      title\n      text\n      points\n      creatorId\n    }\n  }\n"]);return p=function(){return n},n}function v(){var n=a(["\n  mutation DeletePost($id: Int!) {\n    deletePost(id: $id)\n  }\n"]);return v=function(){return n},n}function m(){var n=a(["\n  mutation ForgotPassword($email: String!) {\n    forgotPassword(email: $email)\n  }\n"]);return m=function(){return n},n}function g(){var n=a(["\n  mutation Login($usernameOrEmail: String!, $password: String!) {\n    login(usernameOrEmail: $usernameOrEmail, password: $password) {\n      ...RegularUserResponse\n    }\n  }\n  ","\n"]);return g=function(){return n},n}function h(){var n=a(["\n  mutation Logout {\n    logout\n  }\n"]);return h=function(){return n},n}function y(){var n=a(["\n  mutation Register($options: UsernamePasswordInput!) {\n    register(options: $options) {\n      ...RegularUserResponse\n    }\n  }\n  ","\n"]);return y=function(){return n},n}function P(){var n=a(["\n  mutation UpdatePost($id: Int!, $title: String!, $text: String!) {\n    updatePost(id: $id, title: $title, text: $text) {\n      id\n      title\n      text\n      textSnippet\n    }\n  }\n"]);return P=function(){return n},n}function b(){var n=a(["\n  mutation Vote($value: Int!, $postId: Int!) {\n    vote(value: $value, postId: $postId)\n  }\n"]);return b=function(){return n},n}function x(){var n=a(["\n  query Me {\n    me {\n      id\n      username\n    }\n  }\n"]);return x=function(){return n},n}function w(){var n=a(["\n  query Post($id: Int!) {\n    post(id: $id) {\n      id\n      createdAt\n      updatedAt\n      title\n      points\n      text\n      voteStatus\n      creator {\n        id\n        username\n      }\n    }\n  }\n"]);return w=function(){return n},n}function j(){var n=a(["\n  query Posts($limit: Int!, $cursor: String) {\n    posts(cursor: $cursor, limit: $limit) {\n      hasMore\n      posts {\n        ...PostSnippet\n      }\n    }\n  }\n  ","\n"]);return j=function(){return n},n}var $=(0,e.ZP)(s()),S=(0,e.ZP)(c()),O=(0,e.ZP)(f()),A=(0,e.ZP)(l(),S,O),I=(0,e.ZP)(d(),A);function k(){return o.Db(I)}var U=(0,e.ZP)(p());function Z(){return o.Db(U)}var E=(0,e.ZP)(v());function R(){return o.Db(E)}var q=(0,e.ZP)(m());function _(){return o.Db(q)}var D=(0,e.ZP)(g(),A);function M(){return o.Db(D)}var C=(0,e.ZP)(h());function F(){return o.Db(C)}var z=(0,e.ZP)(y(),A);function N(){return o.Db(z)}var B=(0,e.ZP)(P());function L(){return o.Db(B)}var K=(0,e.ZP)(b());function Q(){return o.Db(K)}var T=(0,e.ZP)(x());function G(n){return o.aM(i({query:T},n))}var H=(0,e.ZP)(w());function V(n){return o.aM(i({query:H},n))}var W=(0,e.ZP)(j(),$);function X(n){return o.aM(i({query:W},n))}},4034:function(n,t,r){r.d(t,{MS:function(){return P}});var e=r(1848),o=r(6997),u=r(9402);function i(n,t,r,e){return n.updateQuery(t,(function(n){return e(r,n)}))}var a=r(2559),s=r(3496),c=r(1163),f=r(7786),l=r(210);function d(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function p(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function v(n){return function(n){if(Array.isArray(n))return d(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(!n)return;if("string"===typeof n)return d(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(n,t)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(){var n=p(["\n                  fragment _ on Post {\n                    id\n                    points\n                    voteStatus\n                  }\n                "]);return m=function(){return n},n}function g(){var n=p(["\n\n                  fragment __ on Post {\n                    points\n                    voteStatus\n                  }\n                  "]);return g=function(){return n},n}var h=function(n){var t=n.forward;return function(n){return(0,s.zG)(t(n),(0,s.bw)((function(n){var t=n.error;(null===t||void 0===t?void 0:t.message.includes("not authenticated"))&&c.default.replace("/login")})))}},y=function(n){n.inspectFields("Query").filter((function(n){return"posts"===n.fieldName})).forEach((function(t){n.invalidate("Query","posts",t.arguments||{})}))},P=function(n,t){var r,s,c="";(0,f.s)()&&(c=null===t||void 0===t||null===(r=t.req)||void 0===r||null===(s=r.headers)||void 0===s?void 0:s.cookie);return console.log("api url is: ","http://localhost:4000/graphql"),{url:"http://localhost:4000/graphql",fetchOptions:{credentials:"include",headers:c?{cookie:c}:void 0},exchanges:[o.B5,(0,a.HG)({keys:{PaginatedPosts:function(){return null}},resolvers:{Query:{posts:function(n,t,r,o){var u=o.parentKey,i=o.fieldName,a=r.inspectFields(u).filter((function(n){return n.fieldName===i}));if(0!==a.length){var s="".concat(i,"(").concat((0,e.h)(t),")"),c=r.resolve(r.resolveFieldByKey(u,s),"posts");o.partial=!c;var f=!0,l=[];return a.forEach((function(n){var t,e=r.resolveFieldByKey(u,n.fieldKey),o=r.resolve(e,"posts"),i=r.resolve(e,"hasMore");i||(f=i),(t=l).push.apply(t,v(o))})),{__typename:"PaginatedPosts",hasMore:f,posts:l}}}}},updates:{Mutation:{deletePost:function(n,t,r,e){r.invalidate({__typename:"Post",id:t.id})},vote:function(n,t,r,e){var o=t.postId,u=t.value,i=r.readFragment((0,l.ZP)(m()),{id:o});if(console.log("data",i),i){if(i.voteStatus===u)return;var a=i.points+(i.voteStatus?2:1)*u;r.writeFragment((0,l.ZP)(g()),{id:o,points:a,voteStatus:u})}},createPost:function(n,t,r,e){y(r)},logout:function(n,t,r,e){i(r,{query:u.en},n,(function(){return{me:null}}))},login:function(n,t,r,e){i(r,{query:u.en},n,(function(n,t){return n.login.errors?t:{me:n.login.user}})),y(r)},register:function(n,t,r,e){i(r,{query:u.en},n,(function(n,t){return n.register.errors?t:{me:n.register.user}}))}}}}),h,n,o.Ek]}}},7786:function(n,t,r){r.d(t,{s:function(){return e}});var e=function(){return!1}}}]);